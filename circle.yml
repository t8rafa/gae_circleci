machine:
    python:
        version: 2.7
    environment:
        APPENGINE_SDK_PATH: "${HOME}/google_appengine"
        CLOUDSDK_CORE_DISABLE_PROMPTS: 1

general:
    artifacts:
        - "nosetests.xml"
        - "coverage.xml"
        - "profile-stats.prof"

dependencies:
    pre:
        - pip install --upgrade pip setuptools logilab-common webapp2
        - python -V
        - pip -V
    override:
        - make install
        - make install-gae-sdk

test:
    override:
        - mkdir -p ${CIRCLE_TEST_REPORTS}/nose
        - NOSE_XUNIT_FILE="${CIRCLE_TEST_REPORTS}/nose/${CIRCLE_PROJECT_REPONAME}.xml" make test